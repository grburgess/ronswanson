{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "943544c9",
   "metadata": {},
   "source": [
    "# Intro\n",
    "\n",
    "So you need to build a table model? 3ML via astromodels provides you with nice facilities to accomplish this task. But often, we need to interface with computationally expensive simulations and require many runs of these simulations. This is a very generic task and Ron Swanson wants to make things as simple as possible for you. Making things complicated is annoying.\n",
    "\n",
    "![alt text](https://raw.githubusercontent.com/grburgess/ronswanson/master/docs/media/mad.jpg)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d50d5ec6",
   "metadata": {},
   "source": [
    "## Example with a Band function\n",
    "\n",
    "Let's say we want to make a table model from a Band function.\n",
    "\n",
    "We pick a parameter grid and a grid of energies for our simulation. We can enter these in a YAML file:\n",
    "\n",
    "```yaml\n",
    "alpha:\n",
    "  custom: no\n",
    "  vmin: -1\n",
    "  vmax: 0\n",
    "  scale: \"linear\"\n",
    "  n_points: 10\n",
    "\n",
    "beta:\n",
    "  custom: no\n",
    "  vmin: -3\n",
    "  vmax: -2\n",
    "  scale: \"linear\"\n",
    "  n_points: 10\n",
    "\n",
    "epeak:\n",
    "  custom: yes\n",
    "  values: [50., 69.74 , 97.29, 135.72, 189.32, 264.097, 368.4, 513.9, 716.87, 1000.]\n",
    "\n",
    "energy_grid:\n",
    "  custom: no\n",
    "  vmin: 10\n",
    "  vmax: 1000\n",
    "  scale: \"log\"\n",
    "  n_points: 50\n",
    "\n",
    "\n",
    "```\n",
    "\n",
    "As can be seen, we can specify the parameter/energy grids ourselves, or we can specify their ranges and let it be done for us.\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "22d7ef92",
   "metadata": {},
   "source": [
    "### The Simulation class\n",
    "\n",
    "Now we need to make a class for the simulation. We will inherit from the simulation class and specify a `_run_call` function that tells the program how to run the simulation for a given set of parameters. This function **must** return an array of photon fluxes for the given energies.\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "f7012cd4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-21T16:34:52.302347Z",
     "iopub.status.busy": "2022-07-21T16:34:52.301634Z",
     "iopub.status.idle": "2022-07-21T16:34:55.966382Z",
     "shell.execute_reply": "2022-07-21T16:34:55.965274Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #00ff00; text-decoration-color: #00ff00\">16:34:55 </span><span style=\"color: #af5fd7; text-decoration-color: #af5fd7\">WARNING </span> <span style=\"color: #c6c6c6; text-decoration-color: #c6c6c6; font-weight: bold\"> The naima package is not available. Models that depend on it will not be         </span><a href=\"file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/functions.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">functions.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/functions.py#50\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">50</span></a>\n",
       "<span style=\"color: #00ff00; text-decoration-color: #00ff00\">         </span>         <span style=\"color: #c6c6c6; text-decoration-color: #c6c6c6; font-weight: bold\">available                                                                         </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">               </span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[38;5;46m16:34:55\u001b[0m\u001b[38;5;46m \u001b[0m\u001b[5;38;5;134mWARNING \u001b[0m \u001b[1;38;5;251m The naima package is not available. Models that depend on it will not be        \u001b[0m\u001b[1;38;5;251m \u001b[0m\u001b]8;id=893881;file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/functions.py\u001b\\\u001b[2mfunctions.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=474537;file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/functions.py#50\u001b\\\u001b[2m50\u001b[0m\u001b]8;;\u001b\\\n",
       "\u001b[38;5;46m         \u001b[0m         \u001b[1;38;5;251mavailable                                                                        \u001b[0m\u001b[1;38;5;251m \u001b[0m\u001b[2m               \u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #00ff00; text-decoration-color: #00ff00\">         </span><span style=\"color: #af5fd7; text-decoration-color: #af5fd7\">WARNING </span> <span style=\"color: #c6c6c6; text-decoration-color: #c6c6c6; font-weight: bold\"> The GSL library or the pygsl wrapper cannot be loaded. Models that depend on it  </span><a href=\"file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/functions.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">functions.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/functions.py#71\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">71</span></a>\n",
       "<span style=\"color: #00ff00; text-decoration-color: #00ff00\">         </span>         <span style=\"color: #c6c6c6; text-decoration-color: #c6c6c6; font-weight: bold\">will not be available.                                                            </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">               </span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[38;5;46m        \u001b[0m\u001b[38;5;46m \u001b[0m\u001b[5;38;5;134mWARNING \u001b[0m \u001b[1;38;5;251m The GSL library or the pygsl wrapper cannot be loaded. Models that depend on it \u001b[0m\u001b[1;38;5;251m \u001b[0m\u001b]8;id=527725;file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/functions.py\u001b\\\u001b[2mfunctions.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=641678;file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/functions.py#71\u001b\\\u001b[2m71\u001b[0m\u001b]8;;\u001b\\\n",
       "\u001b[38;5;46m         \u001b[0m         \u001b[1;38;5;251mwill not be available.                                                           \u001b[0m\u001b[1;38;5;251m \u001b[0m\u001b[2m               \u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #00ff00; text-decoration-color: #00ff00\">         </span><span style=\"color: #af5fd7; text-decoration-color: #af5fd7\">WARNING </span> <span style=\"color: #c6c6c6; text-decoration-color: #c6c6c6; font-weight: bold\"> The ebltable package is not available. Models that depend on it will not be     </span><a href=\"file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/absorption.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">absorption.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/absorption.py#36\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">36</span></a>\n",
       "<span style=\"color: #00ff00; text-decoration-color: #00ff00\">         </span>         <span style=\"color: #c6c6c6; text-decoration-color: #c6c6c6; font-weight: bold\">available                                                                        </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                </span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[38;5;46m        \u001b[0m\u001b[38;5;46m \u001b[0m\u001b[5;38;5;134mWARNING \u001b[0m \u001b[1;38;5;251m The ebltable package is not available. Models that depend on it will not be    \u001b[0m\u001b[1;38;5;251m \u001b[0m\u001b]8;id=477030;file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/absorption.py\u001b\\\u001b[2mabsorption.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=741991;file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/functions_1D/absorption.py#36\u001b\\\u001b[2m36\u001b[0m\u001b]8;;\u001b\\\n",
       "\u001b[38;5;46m         \u001b[0m         \u001b[1;38;5;251mavailable                                                                       \u001b[0m\u001b[1;38;5;251m \u001b[0m\u001b[2m                \u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from typing import Dict\n",
    "\n",
    "import numpy as np\n",
    "from astromodels import Band\n",
    "import ronswanson as dukesilver\n",
    "\n",
    "\n",
    "class BandSimulation(dukesilver.Simulation):\n",
    "    def __init__(\n",
    "        self,\n",
    "        simulation_id: int,\n",
    "        parameter_set: Dict[str, float],\n",
    "        energy_grid: np.ndarray,\n",
    "        out_file: str,\n",
    "    ) -> None:\n",
    "        super().__init__(simulation_id, parameter_set, energy_grid, out_file)\n",
    "\n",
    "    def _run_call(self) -> np.ndarray:\n",
    "\n",
    "        b = Band(\n",
    "            K=1,\n",
    "            alpha=self._parameter_set[\"alpha\"],\n",
    "            beta=self._parameter_set[\"beta\"],\n",
    "            xp=self._parameter_set[\"epeak\"],\n",
    "        )\n",
    "\n",
    "        return b(self._energy_grid)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fb8c5b2e",
   "metadata": {},
   "source": [
    "Now we need to tell the simulation builder a few things so it can construct our files for us. We have stored this YAML file in the repo itself. You should use your own!\n",
    "\n",
    "The `SimulationBuilder` class takes a parameter grid, the name of the file that will be created, the import line for the custom simulation class, the number of cores and nodes to execute on."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "730beb05",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-21T16:34:55.970660Z",
     "iopub.status.busy": "2022-07-21T16:34:55.970395Z",
     "iopub.status.idle": "2022-07-21T16:34:55.981334Z",
     "shell.execute_reply": "2022-07-21T16:34:55.980720Z"
    }
   },
   "outputs": [],
   "source": [
    "from ronswanson.utils.package_data import get_path_of_data_file\n",
    "\n",
    "\n",
    "file_name = get_path_of_data_file(\"test_params.yml\")\n",
    "\n",
    "\n",
    "# create a parameter grid from our file\n",
    "pg = dukesilver.ParameterGrid.from_yaml(file_name)\n",
    "\n",
    "# create a simulation builder\n",
    "sb = dukesilver.SimulationBuilder(\n",
    "    pg,\n",
    "    \"database.h5\",\n",
    "    \"from ronswanson.band_simulation import BandSimulation as Simulation\",\n",
    "    n_cores=8,\n",
    "    use_nodes=None,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b63375a4",
   "metadata": {},
   "source": [
    "Now a python file will be written to the disk which you can run to create your simulation runs. we can have a look at the file.\n",
    "\n",
    "```\n",
    "from ronswanson.band_simulation import BandSimulation as Simulation\n",
    "from joblib import Parallel, delayed\n",
    "from ronswanson import ParameterGrid\n",
    "\n",
    "pg = ParameterGrid.from_yaml('/Users/jburgess/coding/projects/ronswanson/parameters.yml')\n",
    "def func(i):\n",
    "\tparams = pg.at_index(i)\n",
    "\tsimulation = Simulation(i, params, pg.energy_grid.grid,'/Users/jburgess/coding/projects/ronswanson/database.h5')\n",
    "\tsimulation.run()\n",
    "\n",
    "iteration = [i for i in range(0, pg.n_points)]\n",
    "\n",
    "Parallel(n_jobs=8)(delayed(func)(i) for i in iteration)\n",
    "\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a77fa64f",
   "metadata": {},
   "source": [
    "Now this simply uses `joblib` to farm out the iterations over the parameter combinations. If iterations are to also be divided across HPC nodes, the python script will be modified and an associated `SLURM` script will be generated.\n",
    "\n",
    "\n",
    "### The Database\n",
    "\n",
    "\n",
    "\n",
    "Upon running the script, an HDF5 database of the runs is created which contains all the information needed to build a table model in `3ML`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "26733068",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-21T16:34:55.984512Z",
     "iopub.status.busy": "2022-07-21T16:34:55.984281Z",
     "iopub.status.idle": "2022-07-21T16:34:55.988774Z",
     "shell.execute_reply": "2022-07-21T16:34:55.986678Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "from ronswanson.utils.package_data import get_path_of_data_file\n",
    "from ronswanson import Database"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "87af1a94",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-21T16:34:55.991898Z",
     "iopub.status.busy": "2022-07-21T16:34:55.991671Z",
     "iopub.status.idle": "2022-07-21T16:34:56.352712Z",
     "shell.execute_reply": "2022-07-21T16:34:56.351004Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "OrderedDict([('alpha',\n",
       "              array([-1.        , -0.77777778, -0.55555556, -0.33333333, -0.11111111,\n",
       "                      0.11111111,  0.33333333,  0.55555556,  0.77777778,  1.        ])),\n",
       "             ('beta',\n",
       "              array([-3.        , -2.88888889, -2.77777778, -2.66666667, -2.55555556,\n",
       "                     -2.44444444, -2.33333333, -2.22222222, -2.11111111, -2.        ])),\n",
       "             ('epeak',\n",
       "              array([  50.        ,   69.7475397 ,   97.29438588,  135.72088083,\n",
       "                      189.32395047,  264.09759503,  368.40314986,  513.9042664 ,\n",
       "                      716.87116444, 1000.        ]))])"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "db = Database.from_file(get_path_of_data_file(\"test_database.h5\"))\n",
    "db.parameter_ranges"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3ba5cebd",
   "metadata": {},
   "source": [
    "Now we can use the database to construct and save a table model for `3ML`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "15e023f1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-21T16:34:56.356682Z",
     "iopub.status.busy": "2022-07-21T16:34:56.356250Z",
     "iopub.status.idle": "2022-07-21T16:34:56.839726Z",
     "shell.execute_reply": "2022-07-21T16:34:56.838947Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #00ff00; text-decoration-color: #00ff00\">16:34:56 </span><span style=\"color: #af5fd7; text-decoration-color: #af5fd7\">WARNING </span> <span style=\"color: #c6c6c6; text-decoration-color: #c6c6c6; font-weight: bold\"> Energy unit is not a Quantity instance, so units has not been provided.    </span><a href=\"file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/template_model.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">template_model.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/template_model.py#109\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">109</span></a>\n",
       "<span style=\"color: #00ff00; text-decoration-color: #00ff00\">         </span>         <span style=\"color: #c6c6c6; text-decoration-color: #c6c6c6; font-weight: bold\">Using keV.                                                                  </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                     </span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[38;5;46m16:34:56\u001b[0m\u001b[38;5;46m \u001b[0m\u001b[5;38;5;134mWARNING \u001b[0m \u001b[1;38;5;251m Energy unit is not a Quantity instance, so units has not been provided.   \u001b[0m\u001b[1;38;5;251m \u001b[0m\u001b]8;id=585158;file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/template_model.py\u001b\\\u001b[2mtemplate_model.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=97238;file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/template_model.py#109\u001b\\\u001b[2m109\u001b[0m\u001b]8;;\u001b\\\n",
       "\u001b[38;5;46m         \u001b[0m         \u001b[1;38;5;251mUsing keV.                                                                 \u001b[0m\u001b[1;38;5;251m \u001b[0m\u001b[2m                     \u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<ul>\n",
       "\n",
       "<li>description: a new model for 3ML</li>\n",
       "\n",
       "<li>formula: n.a.</li>\n",
       "\n",
       "<li>parameters: \n",
       "<ul>\n",
       "\n",
       "<li>K: \n",
       "<ul>\n",
       "\n",
       "<li>value: 1.0</li>\n",
       "\n",
       "<li>desc: None</li>\n",
       "\n",
       "<li>min_value: None</li>\n",
       "\n",
       "<li>max_value: None</li>\n",
       "\n",
       "<li>unit: </li>\n",
       "\n",
       "<li>is_normalization: False</li>\n",
       "\n",
       "<li>delta: 0.1</li>\n",
       "\n",
       "<li>free: True</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "<li>scale: \n",
       "<ul>\n",
       "\n",
       "<li>value: 1.0</li>\n",
       "\n",
       "<li>desc: None</li>\n",
       "\n",
       "<li>min_value: None</li>\n",
       "\n",
       "<li>max_value: None</li>\n",
       "\n",
       "<li>unit: </li>\n",
       "\n",
       "<li>is_normalization: False</li>\n",
       "\n",
       "<li>delta: 0.1</li>\n",
       "\n",
       "<li>free: True</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "<li>alpha: \n",
       "<ul>\n",
       "\n",
       "<li>value: 0.0</li>\n",
       "\n",
       "<li>desc: None</li>\n",
       "\n",
       "<li>min_value: -1.0</li>\n",
       "\n",
       "<li>max_value: 1.0</li>\n",
       "\n",
       "<li>unit: </li>\n",
       "\n",
       "<li>is_normalization: False</li>\n",
       "\n",
       "<li>delta: 0.1</li>\n",
       "\n",
       "<li>free: True</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "<li>beta: \n",
       "<ul>\n",
       "\n",
       "<li>value: -2.5</li>\n",
       "\n",
       "<li>desc: None</li>\n",
       "\n",
       "<li>min_value: -3.0</li>\n",
       "\n",
       "<li>max_value: -2.0</li>\n",
       "\n",
       "<li>unit: </li>\n",
       "\n",
       "<li>is_normalization: False</li>\n",
       "\n",
       "<li>delta: 0.25</li>\n",
       "\n",
       "<li>free: True</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "<li>epeak: \n",
       "<ul>\n",
       "\n",
       "<li>value: 226.71077275</li>\n",
       "\n",
       "<li>desc: None</li>\n",
       "\n",
       "<li>min_value: 50.0</li>\n",
       "\n",
       "<li>max_value: 1000.0</li>\n",
       "\n",
       "<li>unit: </li>\n",
       "\n",
       "<li>is_normalization: False</li>\n",
       "\n",
       "<li>delta: 22.671077275000002</li>\n",
       "\n",
       "<li>free: True</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "</ul>\n"
      ],
      "text/plain": [
       "  * description: a new model for 3ML\n",
       "  * formula: n.a.\n",
       "  * parameters:\n",
       "    * K:\n",
       "      * value: 1.0\n",
       "      * desc: None\n",
       "      * min_value: null\n",
       "      * max_value: null\n",
       "      * unit: ''\n",
       "      * is_normalization: false\n",
       "      * delta: 0.1\n",
       "      * free: true\n",
       "    * scale:\n",
       "      * value: 1.0\n",
       "      * desc: None\n",
       "      * min_value: null\n",
       "      * max_value: null\n",
       "      * unit: ''\n",
       "      * is_normalization: false\n",
       "      * delta: 0.1\n",
       "      * free: true\n",
       "    * alpha:\n",
       "      * value: 0.0\n",
       "      * desc: None\n",
       "      * min_value: -1.0\n",
       "      * max_value: 1.0\n",
       "      * unit: ''\n",
       "      * is_normalization: false\n",
       "      * delta: 0.1\n",
       "      * free: true\n",
       "    * beta:\n",
       "      * value: -2.5\n",
       "      * desc: None\n",
       "      * min_value: -3.0\n",
       "      * max_value: -2.0\n",
       "      * unit: ''\n",
       "      * is_normalization: false\n",
       "      * delta: 0.25\n",
       "      * free: true\n",
       "    * epeak:\n",
       "      * value: 226.71077275\n",
       "      * desc: None\n",
       "      * min_value: 50.0\n",
       "      * max_value: 1000.0\n",
       "      * unit: ''\n",
       "      * is_normalization: false\n",
       "      * delta: 22.671077275000002\n",
       "      * free: true"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "table_model = db.to_3ml(\"my_model\", \"a new model for 3ML\")\n",
    "table_model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "3b24b146",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-21T16:34:56.843626Z",
     "iopub.status.busy": "2022-07-21T16:34:56.843371Z",
     "iopub.status.idle": "2022-07-21T16:34:58.666812Z",
     "shell.execute_reply": "2022-07-21T16:34:58.665920Z"
    }
   },
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "from astromodels import Band\n",
    "\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "65f256a4",
   "metadata": {},
   "source": [
    "We can compare our table model with the Band function."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "69550fa1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-21T16:34:58.671682Z",
     "iopub.status.busy": "2022-07-21T16:34:58.670853Z",
     "iopub.status.idle": "2022-07-21T16:35:01.070955Z",
     "shell.execute_reply": "2022-07-21T16:35:01.070261Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x7fbbf4d9dcd0>"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ene = np.geomspace(10, 1000, 100)\n",
    "\n",
    "b = Band()\n",
    "b.alpha = -0.6\n",
    "b.beta = -2.5\n",
    "b.xp = 250\n",
    "b.K = 1.05\n",
    "\n",
    "table_model.alpha = -0.6\n",
    "table_model.beta = -2.5\n",
    "table_model.epeak = 250\n",
    "\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "\n",
    "ax.loglog(\n",
    "    ene, ene**2 * table_model(ene), color='#33FFC4', lw=3, label=\"table\"\n",
    ")\n",
    "ax.loglog(ene, ene**2 * b(ene), color='#C989FB', lw=3, label=\"band\")\n",
    "\n",
    "ax.set(xlabel=\"energy\", ylabel=\"vFv\")\n",
    "\n",
    "ax.legend()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5bb80b75",
   "metadata": {},
   "source": [
    "Great! That was way easier than programming everything yourself.\n",
    "\n",
    "![alt text](https://raw.githubusercontent.com/grburgess/ronswanson/master/docs/media/happy.jpeg)\n",
    "\n",
    "\n",
    "Suppose we did not want to use all the values in the parameter ranges we have simulated. Bigger interpolation tables take up memory when fitting.\n",
    "\n",
    "We can select a subset of the parameter ranges when building the table"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "ce323782",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-21T16:35:01.078040Z",
     "iopub.status.busy": "2022-07-21T16:35:01.076801Z",
     "iopub.status.idle": "2022-07-21T16:35:01.307207Z",
     "shell.execute_reply": "2022-07-21T16:35:01.303044Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #00ff00; text-decoration-color: #00ff00\">16:35:01 </span><span style=\"color: #af5fd7; text-decoration-color: #af5fd7\">WARNING </span> <span style=\"color: #c6c6c6; text-decoration-color: #c6c6c6; font-weight: bold\"> Energy unit is not a Quantity instance, so units has not been provided.    </span><a href=\"file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/template_model.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">template_model.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/template_model.py#109\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">109</span></a>\n",
       "<span style=\"color: #00ff00; text-decoration-color: #00ff00\">         </span>         <span style=\"color: #c6c6c6; text-decoration-color: #c6c6c6; font-weight: bold\">Using keV.                                                                  </span><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                     </span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[38;5;46m16:35:01\u001b[0m\u001b[38;5;46m \u001b[0m\u001b[5;38;5;134mWARNING \u001b[0m \u001b[1;38;5;251m Energy unit is not a Quantity instance, so units has not been provided.   \u001b[0m\u001b[1;38;5;251m \u001b[0m\u001b]8;id=986824;file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/template_model.py\u001b\\\u001b[2mtemplate_model.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=307790;file:///opt/hostedtoolcache/Python/3.8.13/x64/lib/python3.8/site-packages/astromodels-2.3.5-py3.8.egg/astromodels/functions/template_model.py#109\u001b\\\u001b[2m109\u001b[0m\u001b]8;;\u001b\\\n",
       "\u001b[38;5;46m         \u001b[0m         \u001b[1;38;5;251mUsing keV.                                                                 \u001b[0m\u001b[1;38;5;251m \u001b[0m\u001b[2m                     \u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<ul>\n",
       "\n",
       "<li>description: a new model for 3ML</li>\n",
       "\n",
       "<li>formula: n.a.</li>\n",
       "\n",
       "<li>parameters: \n",
       "<ul>\n",
       "\n",
       "<li>K: \n",
       "<ul>\n",
       "\n",
       "<li>value: 1.0</li>\n",
       "\n",
       "<li>desc: None</li>\n",
       "\n",
       "<li>min_value: None</li>\n",
       "\n",
       "<li>max_value: None</li>\n",
       "\n",
       "<li>unit: </li>\n",
       "\n",
       "<li>is_normalization: False</li>\n",
       "\n",
       "<li>delta: 0.1</li>\n",
       "\n",
       "<li>free: True</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "<li>scale: \n",
       "<ul>\n",
       "\n",
       "<li>value: 1.0</li>\n",
       "\n",
       "<li>desc: None</li>\n",
       "\n",
       "<li>min_value: None</li>\n",
       "\n",
       "<li>max_value: None</li>\n",
       "\n",
       "<li>unit: </li>\n",
       "\n",
       "<li>is_normalization: False</li>\n",
       "\n",
       "<li>delta: 0.1</li>\n",
       "\n",
       "<li>free: True</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "<li>alpha: \n",
       "<ul>\n",
       "\n",
       "<li>value: -0.5555555555555556</li>\n",
       "\n",
       "<li>desc: None</li>\n",
       "\n",
       "<li>min_value: -1.0</li>\n",
       "\n",
       "<li>max_value: -0.11111111111111116</li>\n",
       "\n",
       "<li>unit: </li>\n",
       "\n",
       "<li>is_normalization: False</li>\n",
       "\n",
       "<li>delta: 0.05555555555555556</li>\n",
       "\n",
       "<li>free: True</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "<li>beta: \n",
       "<ul>\n",
       "\n",
       "<li>value: -2.5</li>\n",
       "\n",
       "<li>desc: None</li>\n",
       "\n",
       "<li>min_value: -3.0</li>\n",
       "\n",
       "<li>max_value: -2.0</li>\n",
       "\n",
       "<li>unit: </li>\n",
       "\n",
       "<li>is_normalization: False</li>\n",
       "\n",
       "<li>delta: 0.25</li>\n",
       "\n",
       "<li>free: True</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "<li>epeak: \n",
       "<ul>\n",
       "\n",
       "<li>value: 368.40314986</li>\n",
       "\n",
       "<li>desc: None</li>\n",
       "\n",
       "<li>min_value: 264.09759503</li>\n",
       "\n",
       "<li>max_value: 513.9042664</li>\n",
       "\n",
       "<li>unit: </li>\n",
       "\n",
       "<li>is_normalization: False</li>\n",
       "\n",
       "<li>delta: 36.840314986</li>\n",
       "\n",
       "<li>free: True</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "</ul>\n",
       "\n",
       "</li>\n",
       "\n",
       "</ul>\n"
      ],
      "text/plain": [
       "  * description: a new model for 3ML\n",
       "  * formula: n.a.\n",
       "  * parameters:\n",
       "    * K:\n",
       "      * value: 1.0\n",
       "      * desc: None\n",
       "      * min_value: null\n",
       "      * max_value: null\n",
       "      * unit: ''\n",
       "      * is_normalization: false\n",
       "      * delta: 0.1\n",
       "      * free: true\n",
       "    * scale:\n",
       "      * value: 1.0\n",
       "      * desc: None\n",
       "      * min_value: null\n",
       "      * max_value: null\n",
       "      * unit: ''\n",
       "      * is_normalization: false\n",
       "      * delta: 0.1\n",
       "      * free: true\n",
       "    * alpha:\n",
       "      * value: -0.5555555555555556\n",
       "      * desc: None\n",
       "      * min_value: -1.0\n",
       "      * max_value: -0.11111111111111116\n",
       "      * unit: ''\n",
       "      * is_normalization: false\n",
       "      * delta: 0.05555555555555556\n",
       "      * free: true\n",
       "    * beta:\n",
       "      * value: -2.5\n",
       "      * desc: None\n",
       "      * min_value: -3.0\n",
       "      * max_value: -2.0\n",
       "      * unit: ''\n",
       "      * is_normalization: false\n",
       "      * delta: 0.25\n",
       "      * free: true\n",
       "    * epeak:\n",
       "      * value: 368.40314986\n",
       "      * desc: None\n",
       "      * min_value: 264.09759503\n",
       "      * max_value: 513.9042664\n",
       "      * unit: ''\n",
       "      * is_normalization: false\n",
       "      * delta: 36.840314986\n",
       "      * free: true"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "selection = {}\n",
    "selection['alpha'] = dict(vmax=0)\n",
    "selection['epeak'] = dict(vmin=200, vmax=700)\n",
    "\n",
    "table_model_small = db.to_3ml(\n",
    "    \"my_model_small\", \"a new model for 3ML\", **selection\n",
    ")\n",
    "table_model_small"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "192d712d",
   "metadata": {},
   "source": [
    "Awesome! Now go enjoy your weekend.\n",
    "\n",
    "![alt text](https://raw.githubusercontent.com/grburgess/ronswanson/master/docs/media/enjoy.jpg)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a80c6db0",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,md"
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
